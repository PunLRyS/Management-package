(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[613],{5725:function(e,t,r){Promise.resolve().then(r.bind(r,2296))},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},4100:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var s=r(7437),a=r(7648),n=r(3145);function l(){return(0,s.jsx)("nav",{className:"fixed top-0 left-0 w-full bg-bgNav text-white p-4 z-20",children:(0,s.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,s.jsx)(a.default,{href:"/",className:"text-lg font-semibold px-2 ",children:(0,s.jsx)(n.default,{src:"/logo.PNG",alt:"Picture of the author",width:50,height:50})}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)(a.default,{href:"/ex_package/Summary",children:(0,s.jsx)("button",{className:"hover:border-b-2 border-white px-2 py-2 font-semibold",children:"Xuất h\xe0ng"})})}),(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)(a.default,{href:"/im_package/AddProduct",children:(0,s.jsx)("button",{className:"hover:border-b-2 border-white px-2 py-2 font-semibold",children:"Nhập h\xe0ng"})})}),(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)(a.default,{href:"/Inventory",children:(0,s.jsx)("button",{className:"hover:border-b-2 border-white px-2 py-2 font-semibold",children:"Kho h\xe0ng"})})})]})]})})}},2296:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var s=r(7437),a=r(2265),n=r(9376),l=r(7648),i=r(4100),o=r(1269),c=r(3145),d=r(4720);function h(){let[e,t]=(0,a.useState)(!1),[r,h]=(0,a.useState)(null),[u,g]=(0,a.useState)(""),[x,b]=(0,a.useState)(""),[m,p]=(0,a.useState)(""),[f,j]=(0,a.useState)([]),[N,y]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),[S,A]=(0,a.useState)([]),[L,k]=(0,a.useState)(""),[C,E]=(0,a.useState)(!0),[I,T]=(0,a.useState)(null),O=(0,n.useRouter)(),_={hidden:{opacity:0,y:50},visible:{opacity:1,y:0}},D=e=>{h(e),t(!0),y(!1)},P=()=>{t(!1),g(""),b(""),h(null)},R=e=>{h(e),g(e.soLuong),b(e.giaNhap),t(!0),y(!0)},G=e=>{let t=f.find(t=>t.id===e);window.confirm("Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng?")&&(A(S.map(r=>r.id===e?{...r,soLuong:r.soLuong+t.soLuong}:r)),j(f.filter(t=>t.id!==e)))},H=S.filter(e=>e.ten.toLowerCase().includes(m.toLowerCase())||e.ma.toLowerCase().includes(m.toLowerCase())),Q=async()=>{try{let e=function(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r="";for(let e=0;e<4;e++)r+=t.charAt(Math.floor(Math.random()*t.length));return r}(0),t={ma:e,danhSachHangHoa:f.map(e=>({maHangHoa:e.ma,soLuong:e.soLuong,giaNhap:e.giaNhap}))};if(console.log("Dữ liệu phiếu xuất sẽ được gửi:",JSON.stringify(t)),!Array.isArray(f))throw Error("exportedItems is not an array");if(!(await fetch("http://localhost:3000/phieu-xuat/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Kh\xf4ng thể tạo phiếu xuất!");for(let t of(localStorage.setItem("exportedItems",JSON.stringify(f)),localStorage.setItem("receiptCode",e),S.map(e=>(f.find(t=>t.id===e.id),e))))if(!(await fetch("http://localhost:3000/hanghoa/update/".concat(t.ma),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({soLuong:t.soLuong})})).ok)throw Error("Kh\xf4ng thể cập nhật số lượng h\xe0ng h\xf3a với ID ".concat(t.ma,"!"));O.push("/ex_package/ListDLC")}catch(e){console.error("Lỗi khi gửi dữ liệu:",e),alert("Đ\xe3 xảy ra lỗi khi gửi dữ liệu!")}};return(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("http://localhost:3000/hanghoa/get-du-lieu");if(!e.ok)throw Error("Lỗi khi tải dữ liệu");let t=await e.json();A(t)}catch(e){T(e.message)}finally{E(!1)}})()},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{}),(0,s.jsx)(c.default,{alt:"Mountains",src:d.Z,placeholder:"blur",quality:100,sizes:"100vw",style:{objectFit:"cover",position:"fixed"},className:"blur-sm absolute w-screen h-screen"}),(0,s.jsxs)(o.E.div,{initial:"hidden",animate:"visible",transition:{duration:.8},variants:_,className:"relative flex flex-col space-y-4 mt-8 pt-16 w-screen",children:[(0,s.jsx)(o.E.h1,{className:"text-4xl text-blue-500 font-bold my-4 text-center",variants:_,transition:{delay:.6},children:"Danh s\xe1ch h\xe0ng h\xf3a"}),(0,s.jsxs)(o.E.div,{className:"flex gap-x-4 my-4 items-center justify-center w-[95%] mx-auto",variants:_,transition:{delay:1.5},children:[(0,s.jsx)("input",{type:"text",placeholder:"T\xecm kiếm theo m\xe3 h\xe0ng hoặc t\xean h\xe0ng",value:m,onChange:e=>p(e.target.value),className:"border border-gray-300 p-2 w-[80%] rounded-lg"}),(0,s.jsx)(l.default,{href:"/ex_package/BillExport",children:(0,s.jsx)("button",{className:"style-button",children:"Xem h\xf3a đơn xuất h\xe0ng"})})]}),(0,s.jsxs)(o.E.table,{className:"min-w-full border-collapse",variants:{hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1}},transition:{duration:.6},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"STT"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"T\xean h\xe0ng"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"Số lượng"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"Gi\xe1"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"Chức năng"})]})}),(0,s.jsx)("tbody",{children:H.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border border-gray-200 p-2 text-center",children:t+1}),(0,s.jsx)("td",{className:"border border-gray-200 p-2 text-center",children:e.ten}),(0,s.jsx)("td",{className:"border border-gray-200 p-2 text-center",children:e.soLuong}),(0,s.jsxs)("td",{className:"border border-gray-200 p-2 text-center",children:[e.giaNhap.toLocaleString()," VNĐ"]}),(0,s.jsx)("td",{className:"border border-gray-200 p-2 text-center",children:(0,s.jsx)("button",{onClick:()=>D(e),className:"style-button",disabled:0===e.soLuong,children:"Xuất h\xe0ng"})})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex items-center w-[92%] mx-auto",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold my-4 text-blue-500",children:"Danh s\xe1ch h\xe0ng được xuất"}),(0,s.jsx)("button",{className:"ml-auto style-button",onClick:()=>{if(0===f.length){alert("Vui l\xf2ng chọn h\xe0ng xuất trước khi đi tới trang đại l\xfd!");return}w(!0)},children:"Đi tới trang đại l\xfd"})]}),(0,s.jsxs)("table",{className:"min-w-full border-collapse border border-gray-200",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"STT"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"T\xean h\xe0ng"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"Số lượng"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"Gi\xe1"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"Tổng gi\xe1"}),(0,s.jsx)("th",{className:"border border-gray-200 p-2",children:"Chức năng"})]})}),(0,s.jsx)("tbody",{children:f.map((e,t)=>{let r=e.soLuong*e.giaNhap;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"border border-gray-200 p-2 text-center",children:t+1}),(0,s.jsx)("td",{className:"border border-gray-200 p-2 text-center",children:e.ten}),(0,s.jsx)("td",{className:"border border-gray-200 p-2 text-center",children:e.soLuong}),(0,s.jsxs)("td",{className:"border border-gray-200 p-2 text-center",children:[e.giaNhap," VNĐ"]}),(0,s.jsxs)("td",{className:"border border-gray-200 p-2 text-center",children:[r.toLocaleString()," VNĐ"]}),(0,s.jsxs)("td",{className:"border border-gray-200 p-2 text-center",children:[(0,s.jsx)("button",{onClick:()=>R(e),className:"style-button",children:"Sửa"}),(0,s.jsx)("button",{onClick:()=>G(e.id),className:"style-button ml-2",children:"X\xf3a"})]})]},e.id)})})]}),e&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-600 bg-opacity-50",children:(0,s.jsxs)("div",{className:"bg-white p-5 rounded shadow-lg",children:[(0,s.jsxs)("h2",{className:"text-lg font-bold mb-4",children:["Nhập th\xf4ng tin xuất h\xe0ng cho ",r.ten]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=parseInt(u),s=parseInt(x);if(isNaN(t)||t<=0||s<=0||isNaN(s)){alert("Số lượng v\xe0 gi\xe1 phải l\xe0 số dương.");return}if(!N){let e=S.find(e=>e.id===r.id);if(t>e.soLuong){alert("Số lượng xuất kh\xf4ng được vượt qu\xe1 ".concat(e.soLuong,"."));return}}S.find(e=>e.id===r.id);let a={id:r.id,ma:r.ma,ten:r.ten,soLuong:t,giaNhap:s};if(N){let e=f.find(e=>e.id===r.id),s=(e?e.soLuong:0)-t;A(S.map(e=>e.id===r.id?{...e,soLuong:e.soLuong+s}:e)),j(f.map(e=>e.id===r.id?a:e))}else j([...f,a]),A(S.map(e=>e.id===r.id?{...e,soLuong:e.soLuong-t}:e));P()},children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block mb-1",children:"Số lượng:"}),(0,s.jsx)("input",{type:"number",value:u,onChange:e=>g(e.target.value),className:"border border-gray-300 p-2 w-full",required:!0})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block mb-1",children:"Gi\xe1:"}),(0,s.jsx)("input",{type:"number",value:x,onChange:e=>b(e.target.value),className:"border border-gray-300 p-2 w-full",required:!0})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("button",{type:"submit",className:"style-button",children:"X\xe1c nhận"}),(0,s.jsx)("button",{type:"button",onClick:P,className:"style-button",children:"Hủy"})]})]})]})}),v&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"bg-white p-5 rounded-lg shadow-md",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Bạn c\xf3 chắc chắn với th\xf4ng tin của m\xecnh kh\xf4ng?"}),(0,s.jsxs)("div",{className:"flex justify-end",children:[(0,s.jsx)("button",{className:"style-button mr-4",onClick:()=>w(!1),children:"Kh\xf4ng"}),(0,s.jsx)("button",{className:"style-button",onClick:Q,children:"C\xf3"})]})]})})]})]})}},4720:function(e,t){"use strict";t.Z={src:"/_next/static/media/Baixar-fundo-abstrato-hex\xe1gono_-conceito-poligonal-de-tecnologia-gratuitamente.c3777ead.png",height:368,width:736,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAIAAAA8r+mnAAAATUlEQVR42h3JSQ7AIAwDQCdE9P8P7aIeQIhgd5nrWOs9Ioq7mQGQtMg5M1JW/YPf2xTOqbjnGmY1isitFIj7yCsZLbl8HUkDAwlRcIcebEcveohQeW0AAAAASUVORK5CYII=",blurWidth:8,blurHeight:4}}},function(e){e.O(0,[891,971,117,744],function(){return e(e.s=5725)}),_N_E=e.O()}]);